<Page x:Class="ADMigrationTool.Views.UsersGroupsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Users &amp; Groups">

    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Users &amp; Groups" FontSize="20" FontWeight="Bold" Margin="0,0,0,8" />

        <!-- Toolbar -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12">
            <Button Content="Refresh" Padding="12,6" Margin="0,0,8,0" Click="Refresh_Click" />
            <Button Content="Select All" Padding="12,6" Margin="0,0,8,0" Click="SelectAll_Click" />
            <Button Content="Deselect All" Padding="12,6" Margin="0,0,8,0" Click="DeselectAll_Click" />
            <Button Content="Export to CSV" Padding="12,6" Margin="0,0,8,0" Click="ExportCsv_Click" />
            <TextBox x:Name="SearchBox" Width="250" Padding="6" Margin="16,0,0,0"
                     TextChanged="SearchBox_TextChanged" />
        </StackPanel>

        <!-- Tab Control for Users / Groups -->
        <TabControl Grid.Row="2">
            <TabItem Header="Users">
                <DataGrid x:Name="UsersGrid" AutoGenerateColumns="False" IsReadOnly="False"
                          CanUserSortColumns="True" SelectionMode="Extended">
                    <DataGrid.Columns>
                        <DataGridCheckBoxColumn Header="Select" Binding="{Binding IsSelected}" />
                        <DataGridTextColumn Header="Display Name" Binding="{Binding DisplayName}" Width="180" />
                        <DataGridTextColumn Header="SAM Account" Binding="{Binding SamAccountName}" Width="140" />
                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200" />
                        <DataGridTextColumn Header="OU" Binding="{Binding OrganizationalUnit}" Width="200" />
                        <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" />
                        <DataGridTextColumn Header="Last Logon" Binding="{Binding LastLogon}" Width="140" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Groups">
                <DataGrid x:Name="GroupsGrid" AutoGenerateColumns="False" IsReadOnly="False"
                          CanUserSortColumns="True" SelectionMode="Extended">
                    <DataGrid.Columns>
                        <DataGridCheckBoxColumn Header="Select" Binding="{Binding IsSelected}" />
                        <DataGridTextColumn Header="Group Name" Binding="{Binding Name}" Width="200" />
                        <DataGridTextColumn Header="Type" Binding="{Binding GroupType}" Width="120" />
                        <DataGridTextColumn Header="Scope" Binding="{Binding GroupScope}" Width="120" />
                        <DataGridTextColumn Header="Members" Binding="{Binding MemberCount}" Width="80" />
                        <DataGridTextColumn Header="OU" Binding="{Binding OrganizationalUnit}" Width="200" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>
    </Grid>
</Page>
