<Page x:Class="ADMigrationTool.Views.ReportsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Reports">

    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock Text="Migration Reports" FontSize="20" FontWeight="Bold" Margin="0,0,0,8" />
            <StackPanel Orientation="Horizontal">
                <Button Content="Generate Pre-Migration Report" Padding="12,6" Margin="0,0,8,0"
                        Click="PreMigrationReport_Click" />
                <Button Content="Generate Post-Migration Report" Padding="12,6" Margin="0,0,8,0"
                        Click="PostMigrationReport_Click" />
                <Button Content="Export All Reports" Padding="12,6"
                        Click="ExportReports_Click" />
            </StackPanel>
        </StackPanel>

        <TabControl Grid.Row="1">
            <TabItem Header="Summary">
                <ScrollViewer>
                    <StackPanel x:Name="SummaryPanel" Margin="8" />
                </ScrollViewer>
            </TabItem>
            <TabItem Header="User Migration Log">
                <DataGrid x:Name="UserMigrationLog" AutoGenerateColumns="False" IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="User" Binding="{Binding UserName}" Width="180" />
                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100" />
                        <DataGridTextColumn Header="Source OU" Binding="{Binding SourceOU}" Width="200" />
                        <DataGridTextColumn Header="Target OU" Binding="{Binding TargetOU}" Width="200" />
                        <DataGridTextColumn Header="Errors" Binding="{Binding Errors}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Group Migration Log">
                <DataGrid x:Name="GroupMigrationLog" AutoGenerateColumns="False" IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Group" Binding="{Binding GroupName}" Width="200" />
                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100" />
                        <DataGridTextColumn Header="Members Migrated" Binding="{Binding MembersMigrated}" Width="140" />
                        <DataGridTextColumn Header="Errors" Binding="{Binding Errors}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            <TabItem Header="Error Log">
                <ListBox x:Name="ErrorLog" FontFamily="Consolas" FontSize="12" />
            </TabItem>
        </TabControl>
    </Grid>
</Page>
